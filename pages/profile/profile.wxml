<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- 用户信息区域 - 未认证 -->
  <view class="unauth-section" wx:if="{{!certStatus || certStatus === 'pending'}}">
    <!-- 顶部装饰 -->
    <view class="top-decoration">
      <view class="decoration-circle circle-1"></view>
      <view class="decoration-circle circle-2"></view>
      <view class="decoration-circle circle-3"></view>
    </view>

    <!-- 用户头像区域 -->
    <view class="user-card">
      <image class="avatar-large" src="{{userInfo.avatarUrl}}" mode="cover"></image>
      <text class="nickname-large">{{hasUserInfo ? userInfo.nickName : '欢迎来到健康100'}}</text>
      <text class="user-status" wx:if="{{certStatus === 'pending'}}">
        <text class="status-icon">⏳</text>
        认证审核中...
      </text>
      <text class="user-status" wx:elif="{{hasUserInfo}}">
        <text class="status-icon">👋</text>
        您还未认证，快来完成认证吧
      </text>
      <text class="user-status" wx:else>
        <text class="status-icon">💙</text>
        登录后享受更多健康服务
      </text>
    </view>

    <!-- 登录/认证按钮 -->
    <view class="action-buttons">
      <button wx:if="{{!hasUserInfo}}" class="primary-btn" bindtap="getUserProfile">
        <text class="btn-icon">🔐</text>
        <text class="btn-text">微信授权登录</text>
      </button>
      
      <button wx:if="{{hasUserInfo && !certStatus}}" class="primary-btn" bindtap="goToCertification">
        <text class="btn-icon">✨</text>
        <text class="btn-text">立即认证</text>
      </button>
    </view>

    <!-- 认证权益说明 -->
    <view class="benefits-card" wx:if="{{hasUserInfo && !certStatus}}">
      <view class="benefits-title">
        <text class="title-icon">🎁</text>
        <text>认证后可享受</text>
      </view>
      <view class="benefits-grid">
        <view class="benefit-box">
          <text class="benefit-emoji">👨‍⚕️</text>
          <text class="benefit-name">专业认证</text>
        </view>
        <view class="benefit-box">
          <text class="benefit-emoji">📚</text>
          <text class="benefit-name">在线学习</text>
        </view>
        <view class="benefit-box">
          <text class="benefit-emoji">💬</text>
          <text class="benefit-name">互动交流</text>
        </view>
        <view class="benefit-box">
          <text class="benefit-emoji">🏆</text>
          <text class="benefit-name">积分奖励</text>
        </view>
      </view>
    </view>

    <!-- 退出登录按钮（在未认证区域内） -->
    <button wx:if="{{hasUserInfo && !certStatus}}" class="logout-btn-inline" bindtap="logout">
      <text class="logout-icon">🚪</text>
      <text>退出登录</text>
    </button>
  </view>

  <!-- 用户信息区域 - 已认证医生 -->
  <view class="doctor-info-section" wx:if="{{certStatus === 'doctor' && doctorInfo}}">
    <!-- 医生卡片 -->
    <view class="doctor-card">
      <!-- 顶部通知和编辑按钮 -->
      <view class="card-actions">
        <!-- <view class="edit-btn">✏️</view> -->
        <view class="notification-btn">
          <image class="bell-icon" src="/images/bell-icon.png" mode="aspectFit"></image>
          <view class="notification-dot"></view>
        </view>
      </view>

      <!-- 医生信息 -->
       <view class="doctor-info-wrapper">
        <view class="doctor-info">
        <image class="doctor-avatar-large" src="{{doctorInfo.photoUrl || userInfo.avatarUrl}}" mode="cover"></image>
        <view class="doctor-details">
          <view class="name-row">
            <text class="doctor-name-large">{{doctorInfo.name}}</text>
            <image class="verify-badge" src="/images/doctor-certification.png" mode="aspectFit"></image>
          </view>
          <view class="position-row">
            <text class="doctor-position">{{doctorInfo.department}} | {{doctorInfo.title}}</text>
            <image class="edit-icon" src="/images/edit.png" mode="aspectFit" bindtap="goToEdit"></image>
          </view>
          <text class="doctor-hospital-name">{{doctorInfo.hospital}}</text>
        </view>
      </view>
      </view>

      <!-- 权益提示 -->
      <view class="privilege-hint">
        <text class="privilege-text">您已解锁 · 项权益 ></text>



      <view class="function-buttons">
        <view class="function-item">
          <view class="function-icon">
            <image class="icon-image" src="/images/ic-1.png" mode="aspectFit"></image>
          </view>
          <text class="function-label">健康筛查</text>
        </view>
        <view class="function-item">
          <view class="function-icon">
            <image class="icon-image" src="/images/ic-2.png" mode="aspectFit"></image>
          </view>
          <text class="function-label">发布创作</text>
        </view>
        <view class="function-item">
          <view class="function-icon">
            <image class="icon-image" src="/images/ic-3.png" mode="aspectFit"></image>
          </view>
          <text class="function-label">我的课程</text>
        </view>
        <view class="function-item">
          <view class="function-icon">
            <image class="icon-image" src="/images/ic-4.png" mode="aspectFit"></image>
          </view>
          <text class="function-label">积分管理</text>
        </view>
        <view class="function-item">
          <view class="function-icon">
            <image class="icon-image" src="/images/ic-5.png" mode="aspectFit"></image>
          </view>
          <text class="function-label">分享码</text>
        </view>
      </view>
        
      </view>
         <!-- <view class="function-buttons">
        <view class="function-item">
          <view class="function-icon health-check">
            <text class="icon-text">📋</text>
          </view>
          <text class="function-label">健康筛查</text>
        </view>
        <view class="function-item">
          <view class="function-icon publish">
            <text class="icon-text">📱</text>
          </view>
          <text class="function-label">发布创作</text>
        </view>
        <view class="function-item">
          <view class="function-icon course">
            <text class="icon-text">⛳</text>
          </view>
          <text class="function-label">我的课程</text>
        </view>
        <view class="function-item">
          <view class="function-icon points">
            <text class="icon-text">🏆</text>
          </view>
          <text class="function-label">积分管理</text>
        </view>
        <view class="function-item">
          <view class="function-icon share">
            <text class="icon-text">💳</text>
          </view>
          <text class="function-label">分享码</text>
        </view>
      </view> -->

      <!-- 功能按钮组 -->
   
    </view>

    <!-- 视频列表区域 -->
    <view class="doctor-video-section">
      <!-- 分类标签 -->
      <scroll-view class="category-tabs" scroll-x enable-flex>
        <view class="category-item {{activeCategory === item.id ? 'active' : ''}}" 
              wx:for="{{videoCategories}}" 
              wx:key="id" 
              bindtap="onVideoCategoryTap" 
              data-id="{{item.id}}">
          {{item.name}}
        </view>
      </scroll-view>
      
      <view class="video-list">
        <view class="video-item" wx:for="{{doctorVideos}}" wx:key="id" bindtap="onVideoTap" data-id="{{item.id}}">
          <image src="{{item.cover}}" mode="aspectFill" class="video-cover"></image>
          <view class="video-info">
            <text class="video-title">{{item.title}}</text>
            <view class="video-meta">
              <view class="video-author">
                <image src="{{item.avatar}}" mode="aspectFill" class="author-avatar"></image>
                <text class="author-name">{{item.author}}</text>
              </view>
              <view class="video-likes">
                <image src="/images/like.png" mode="aspectFit" class="like-icon"></image>
                <text class="likes-count">{{item.likes}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 用户信息区域 - 已认证患者 -->
  <view class="patient-info-section" wx:if="{{certStatus === 'patient'}}">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatarUrl}}" mode="cover"></image>
      <view class="user-detail">
        <text class="nickname">{{userInfo.nickName}}</text>
        <text class="user-id">
          <text class="patient-badge">✓ 已认证患者</text>
        </text>
      </view>
    </view>
  </view>

  <!-- 退出登录按钮（仅已认证用户在外部显示） -->
  <view class="logout-section" wx:if="{{hasUserInfo && certStatus}}">
    <button class="logout-btn" bindtap="logout">
      <text class="logout-icon">🚪</text>
      <text>退出登录</text>
    </button>
  </view>
</view>

