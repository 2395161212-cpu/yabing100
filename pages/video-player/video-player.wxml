<!--pages/video-player/video-player.wxml-->
<view class="container">
  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-btn" bindtap="onBackTap">
    <text class="back-icon">â†</text>
  </view>
  
  <swiper 
    class="video-swiper" 
    vertical 
    current="{{currentIndex}}" 
    bindchange="onSwiperChange"
    circular="{{false}}"
  >
    <swiper-item wx:for="{{videoList}}" wx:key="id" class="video-item">
      <video 
        id="video-{{index}}"
        src="{{item.videoUrl}}"
        poster="{{item.cover}}"
        class="video-player"
        object-fit="contain"
        show-center-play-btn="{{false}}"
        show-play-btn="{{true}}"
        controls="{{true}}"
        autoplay="{{currentIndex === index}}"
        bindended="onVideoEnded"
        bindplay="onVideoPlay"
        bindpause="onVideoPause"
        binderror="onVideoError"
        bindwaiting="onVideoWaiting"
        bindloadeddata="onVideoLoaded"
        data-index="{{index}}"
      ></video>
      
      <!-- è§†é¢‘åŠ è½½çŠ¶æ€æç¤º -->
      <view class="video-loading" wx:if="{{currentIndex === index && videoLoading}}">
        <text>è§†é¢‘åŠ è½½ä¸­...</text>
      </view>
      
      <!-- è§†é¢‘é”™è¯¯æç¤º -->
      <view class="video-error" wx:if="{{videoError && currentIndex === index}}">
        <text>âŒ</text>
        <text class="error-text">è§†é¢‘åŠ è½½å¤±è´¥</text>
        <text class="error-detail">{{videoErrorMsg}}</text>
      </view>
      
      <!-- è§†é¢‘ä¿¡æ¯å±‚ -->
      <view class="video-info-overlay">
        <view class="video-meta">
          <text class="video-title">{{item.title}}</text>
          <view class="video-author-info">
            <text class="author-name">@{{item.author}}</text>
            <text class="video-desc" wx:if="{{item.description}}">{{item.description}}</text>
          </view>
        </view>
        
        <!-- å³ä¾§æ“ä½œæ  -->
        <view class="video-actions">
          <view class="action-item" bindtap="onLikeTap" data-index="{{index}}">
            <text class="action-icon">{{item.liked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
            <text class="action-text">{{item.likes}}</text>
          </view>
          <view class="action-item" bindtap="onCommentTap" data-index="{{index}}">
            <text class="action-icon">ğŸ’¬</text>
            <text class="action-text">{{item.comments}}</text>
          </view>
          <view class="action-item" bindtap="onShareTap" data-index="{{index}}">
            <text class="action-icon">ğŸ“¤</text>
            <text class="action-text">åˆ†äº«</text>
          </view>
        </view>
      </view>
      
      <!-- æ»‘åŠ¨æç¤º -->
      <view class="swipe-tip" wx:if="{{showTip && currentIndex === index}}">
        <text>{{tipText}}</text>
      </view>
    </swiper-item>
  </swiper>
  
  <!-- åŠ è½½æç¤º -->
  <view class="loading-toast" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>

