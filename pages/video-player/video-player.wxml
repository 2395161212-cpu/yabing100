<!--pages/video-player/video-player.wxml-->
<view class="container">
  <!-- ËøîÂõûÊåâÈíÆ -->
  <view class="back-btn" bindtap="onBackTap">
    <text class="back-icon">‚Üê</text>
  </view>
  
  <swiper 
    class="video-swiper" 
    vertical 
    current="{{currentIndex}}" 
    bindchange="onSwiperChange"
    circular="{{false}}"
  >
    <swiper-item wx:for="{{videoList}}" wx:key="id" class="video-item">
      <video 
        id="video-{{index}}"
        src="{{item.videoUrl}}"
        poster="{{item.cover}}"
        class="video-player"
        object-fit="contain"
        show-center-play-btn="{{false}}"
        show-play-btn="{{true}}"
        controls="{{true}}"
        autoplay="{{currentIndex === index}}"
        bindended="onVideoEnded"
        bindplay="onVideoPlay"
        bindpause="onVideoPause"
        binderror="onVideoError"
        bindwaiting="onVideoWaiting"
        bindloadeddata="onVideoLoaded"
        data-index="{{index}}"
      ></video>
      
      <!-- ËßÜÈ¢ëÂä†ËΩΩÁä∂ÊÄÅÊèêÁ§∫ -->
      <view class="video-loading" wx:if="{{currentIndex === index && videoLoading}}">
        <text>ËßÜÈ¢ëÂä†ËΩΩ‰∏≠...</text>
      </view>
      
      <!-- ËßÜÈ¢ëÈîôËØØÊèêÁ§∫ -->
      <view class="video-error" wx:if="{{videoError && currentIndex === index}}">
        <text>‚ùå</text>
        <text class="error-text">ËßÜÈ¢ëÂä†ËΩΩÂ§±Ë¥•</text>
        <text class="error-detail">{{videoErrorMsg}}</text>
      </view>
      
      <!-- ËßÜÈ¢ë‰ø°ÊÅØÂ±Ç -->
      <view class="video-info-overlay">
        <view class="video-meta">
          <text class="video-title">{{item.title}}</text>
          <view class="video-author-info">
            <text class="author-name">@{{item.author}}</text>
            <text class="video-desc" wx:if="{{item.description}}">{{item.description}}</text>
          </view>
        </view>
        
        <!-- Âè≥‰æßÊìç‰ΩúÊ†è -->
        <view class="video-actions">
          <view class="action-item" bindtap="onLikeTap" data-index="{{index}}">
            <text class="action-icon">{{item.liked ? '‚ù§Ô∏è' : 'ü§ç'}}</text>
            <text class="action-text">{{item.likes}}</text>
          </view>
        </view>
      </view>
      
      <!-- ÊªëÂä®ÊèêÁ§∫ -->
      <view class="swipe-tip" wx:if="{{showTip && currentIndex === index}}">
        <text>{{tipText}}</text>
      </view>
    </swiper-item>
  </swiper>
  
  <!-- Âä†ËΩΩÊèêÁ§∫ -->
  <view class="loading-toast" wx:if="{{loading}}">
    <text>Âä†ËΩΩ‰∏≠...</text>
  </view>
</view>

